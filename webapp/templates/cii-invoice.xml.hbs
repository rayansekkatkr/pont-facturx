<?xml version="1.0" encoding="UTF-8"?>
<!-- données « métier » (numérotées en commençant par « BT- »)  -->
<!-- sous-groupes de données métiers (numérotés en commençant par « BG- ») -->
<rsm:CrossIndustryInvoice xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:qdt="urn:un:unece:uncefact:data:standard:QualifiedDataType:100"
  xmlns:udt="urn:un:unece:uncefact:data:standard:UnqualifiedDataType:100"
  xmlns:rsm="urn:un:unece:uncefact:data:standard:CrossIndustryInvoice:100"
  xmlns:ram="urn:un:unece:uncefact:data:standard:ReusableAggregateBusinessInformationEntity:100">

  <!-- BG-2 : groupe « Contrôle de Processus » : entête de message, groupe Obligatoire -->
  <rsm:ExchangedDocumentContext>
    <!-- BT-23 : process (optionnel selon cas d'usage) -->
    {{#if (lookup bt "BT-23")}}
    <ram:BusinessProcessSpecifiedDocumentContextParameter>
      <ram:ID>{{lookup bt "BT-23"}}</ram:ID>
    </ram:BusinessProcessSpecifiedDocumentContextParameter>
    {{/if}}

    <!-- BT-24 : Identification de spécification : référence au format et profil utilisé : donnée Obligatoire -->
    <ram:GuidelineSpecifiedDocumentContextParameter>
      <ram:ID>{{lookup bt "BT-24"}}</ram:ID>
    </ram:GuidelineSpecifiedDocumentContextParameter>
  </rsm:ExchangedDocumentContext>

  <!-- entête du Document -->
  <rsm:ExchangedDocument>
    <!-- BT-1 : numéro de facture -->
    <ram:ID>{{lookup bt "BT-1"}}</ram:ID>

    <!-- BT-3 : type de facture (380 = facture commerciale) -->
    <ram:TypeCode>{{lookup bt "BT-3"}}</ram:TypeCode>

    <!-- BT-2 : date d’émission de la facture -->
    <ram:IssueDateTime>
      <udt:DateTimeString format="102">{{lookup bt "BT-2"}}</udt:DateTimeString>
    </ram:IssueDateTime>
  </rsm:ExchangedDocument>

  <!-- données de la facture -->
  <rsm:SupplyChainTradeTransaction>
    <ram:ApplicableHeaderTradeAgreement>

      <!-- BG-4 : groupe d’information sur le vendeur -->
      <ram:SellerTradeParty>
        <!-- BT-27 : nom (raison sociale) du fournisseur -->
        <ram:Name>{{lookup bt "BT-27"}}</ram:Name>

        <!-- BT-30 : identification légale du vendeur (SIREN) -->
        {{#if (lookup bt "BT-30")}}
        <ram:SpecifiedLegalOrganization>
          <ram:ID schemeID="0002">{{lookup bt "BT-30"}}</ram:ID>
        </ram:SpecifiedLegalOrganization>
        {{/if}}

        <!-- BG-5 : pays du fournisseur -->
        <ram:PostalTradeAddress>
          <ram:CountryID>{{lookup bt "BT-29"}}</ram:CountryID>
        </ram:PostalTradeAddress>

        <!-- BT-31 : numéro de TVA intracommunautaire -->
        {{#if (lookup bt "BT-31")}}
        <ram:SpecifiedTaxRegistration>
          <ram:ID schemeID="VA">{{lookup bt "BT-31"}}</ram:ID>
        </ram:SpecifiedTaxRegistration>
        {{/if}}
      </ram:SellerTradeParty>

      <!-- BG-7 : groupe d’information de l’acheteur -->
      <ram:BuyerTradeParty>
        <!-- BT-44 : nom de l’acheteur (raison sociale) -->
        <ram:Name>{{lookup bt "BT-44"}}</ram:Name>

        <!-- BT-47 : identification légale de l’acheteur (SIREN) -->
        {{#if (lookup bt "BT-47")}}
        <ram:SpecifiedLegalOrganization>
          <ram:ID schemeID="0002">{{lookup bt "BT-47"}}</ram:ID>
        </ram:SpecifiedLegalOrganization>
        {{/if}}
      </ram:BuyerTradeParty>

      <!-- BT-13 : numéro de commande fourni par l’acheteur (optionnel) -->
      {{#if (lookup bt "BT-13")}}
      <ram:BuyerOrderReferencedDocument>
        <ram:IssuerAssignedID>{{lookup bt "BT-13"}}</ram:IssuerAssignedID>
      </ram:BuyerOrderReferencedDocument>
      {{/if}}

    </ram:ApplicableHeaderTradeAgreement>

    <!-- Un bloc vide (pour conformité du message) informations de livraison -->
    <ram:ApplicableHeaderTradeDelivery/>

    <!-- données de la facture -->
    <ram:ApplicableHeaderTradeSettlement>
      <!-- BT-5 : devise de la facture -->
      <ram:InvoiceCurrencyCode>{{lookup bt "BT-5"}}</ram:InvoiceCurrencyCode>

      <!-- BG-22 : montants totaux -->
      <ram:SpecifiedTradeSettlementHeaderMonetarySummation>
        <!-- BT-109 : montant HT -->
        <ram:TaxBasisTotalAmount>{{lookup bt "BT-109"}}</ram:TaxBasisTotalAmount>

        <!-- BT-110 : montant de la TVA où currencyID = BT-5 -->
        <ram:TaxTotalAmount currencyID="{{lookup bt "BT-5"}}">{{lookup bt "BT-110"}}</ram:TaxTotalAmount>

        <!-- BT-112 : montant TTC -->
        <ram:GrandTotalAmount>{{lookup bt "BT-112"}}</ram:GrandTotalAmount>

        <!-- BT-115 : montant net à payer -->
        <ram:DuePayableAmount>{{lookup bt "BT-115"}}</ram:DuePayableAmount>
      </ram:SpecifiedTradeSettlementHeaderMonetarySummation>
    </ram:ApplicableHeaderTradeSettlement>
  </rsm:SupplyChainTradeTransaction>
</rsm:CrossIndustryInvoice>
